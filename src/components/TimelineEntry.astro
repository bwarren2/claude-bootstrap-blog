---
import StatusBadge from "./StatusBadge.astro";
import TechTag from "./TechTag.astro";
import type { CollectionEntry } from "astro:content";

interface Props {
  project: CollectionEntry<"projects">;
}

const { project } = Astro.props;
const { title, description, status, techStack, pubDate } = project.data;
const base = import.meta.env.BASE_URL.replace(/\/?$/, "/");
const formattedDate = pubDate.toLocaleDateString("en-US", {
  year: "numeric",
  month: "short",
  day: "numeric",
});
---

<div class="relative pl-8 pb-8 border-l-2 border-border last:border-l-0 last:pb-0">
  <!-- Timeline dot -->
  <div class="absolute -left-[9px] top-0 w-4 h-4 rounded-full border-2 border-brand bg-surface"></div>

  <div class="rounded-lg border border-border bg-surface p-5 hover:border-brand/50 transition-colors">
    <div class="flex items-start justify-between gap-3 mb-2">
      <a
        href={`${base}projects/${project.id}/`}
        class="text-lg font-semibold text-text-primary hover:text-brand transition-colors"
      >
        {title}
      </a>
      <StatusBadge status={status} size="sm" />
    </div>

    <time class="text-xs text-text-secondary mb-2 block" datetime={pubDate.toISOString()}>
      {formattedDate}
    </time>

    <p class="text-sm text-text-secondary mb-3">{description}</p>

    <div class="flex flex-wrap gap-1.5">
      {techStack.slice(0, 4).map((tech) => <TechTag tech={tech} size="sm" />)}
    </div>
  </div>
</div>
